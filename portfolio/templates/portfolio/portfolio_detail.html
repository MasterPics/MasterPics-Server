{% extends 'core/layout.html' %}

{% load static %}
{% block stylesheet %}
<link rel="stylesheet" href="{% static 'css/portfolio_detail.css' %}">
{% endblock stylesheet %}

{% block content %}
<div class="choose">
{% if portfolio_owner == request.user %}
    <a class="choose_profile" href="{% url 'profile:mypage' %}"><div class="btn"><span class="noselect">Show Profile</span></div></a>
{% else %}
    {% comment %} <a class="choose_profile" href="{% url 'profile:others_profile' portfolio_owner.user_identifier %}"><div class="btn"><span class="noselect">Show Profile</span></div></a> {% endcomment %}
{% endif %}
</div>

<div class="container_4">
    <!-- 게시글 작성자 정보 -->
    <div class="user">
        <div class="user_img">
            {% if portfolio_owner.image  %}
            <img class="profile_image" src="{{portfolio_owner.image.url}}" alt="profile_image">
            {% else %}
            <img class="profile_image"
                src="https://cdn.iconscout.com/icon/free/png-512/account-profile-avatar-man-circle-round-user-30452.png"
                alt="profile_image">
            {% endif %}
        </div>
        <div class="portfolio_owner">User: {{portfolio_owner.username}}</div>
        <div class="portfolio_owner">Category: {{portfolio_owner.category}}</div>
    </div>






<div class="portfolio_detail">
    <div class="detail_left">
        <!-- carousel, next/previous controls -->
        <div class="slides">
            <div class="mySlides fade">
                <div class="numbertext">1 / {{ images.count }}</div>
                    <div class="img_container"><img src="{{portfolio.thumbnail.image.url}}"></div>
            </div>
            {% for image in images %}
                {% if image %}
                    <div class="mySlides fade">
                        <div class="numbertext"> {{forloop.counter }} / {{ images.count }}</div>
                        <div class="img_container"><img src="{{image.image.url}}"></div>
                    </div>
                {% endif %}
            {% endfor %}
            <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
            <a class="next" onclick="plusSlides(1)">&#10095;</a>
        </div>

        
        <!-- desc, tag, date -->
        <div class="portfolio_content">{{portfolio.desc}}</div>
        <div class="portfolio_tags">
            {% for tag in tags %}
            <a href="" class="portfolio_tag tag-button">
                #{{ tag.name }} 
            </a>
            {% endfor %}
        </div>
        <div class="portfolio_date">
            <!-- TODO 날짜기준 -->
            <div class="portfolio_content">{{portfolio.created_at}}</div>
            <!-- <div class="portfolio_content"> {{portfolio.updated_at}}</div> -->
        </div>

        <!-- like, view_count, save -->
        <div class="portfolio_info">
            <div class="like like-{{portfolio.id}}">
                {% if request.user in like_users %}
                <i class="fas fa-heart" type="submit" onclick="onClickLike({{ portfolio.id }})" name="type"
                    value="like"></i>
                {% else %}
                <i class="far fa-heart" type="submit" onclick="onClickLike({{ portfolio.id }})" name="type"
                    value="like"></i>
                {% endif %}
                {% comment %}
                <span class="like__content">{{ portfolio.like_users.count }}</span>  
                {% endcomment %}
                
            </div>
        
            <div class="toright">
                <div class="eye">
                    <i class="far fa-eye"></i>
                    {% comment %}
                    <span class="view__content">{{portfolio.view_count}}</span>  
                    {% endcomment %}
                    
                </div>
                <div class="save save-{{portfolio.id}}">
                    {% if request.user in bookmark_users %}
                    <i class="fas fa-bookmark" type="submit" onclick="onClickSave({{ portfolio.id }})" name="type"
                        value="save"></i>
                    {% else %}
                    <i class="far fa-bookmark" type="submit" onclick="onClickSave({{ portfolio.id }})" name="type"
                        value="save"></i>
                    {% endif %}
                    {% comment %}
                    <span class="save__content">{{ portfolio.save_users.count }}</span>  
                    {% endcomment %}
                    
                </div>
            </div>
        </div>



            <!--PortFolio Comments 적절한 위치에 배치해야 합니다.-->
            {% for comment in comments %}
            <div class="comment comment-{{ comment.id }}">
                <span>{{ comment.writer }}</span>
                <span>{{ comment.content }}</span>
                <span>{{ comment.created_at }}</span>
                <input class="comment-btn" onclick="onClickDeleteComment({{ comment.id }})" type="submit" value="삭제">
            </div>
            {% endfor %}



        <!-- 게시글 작성자만 수정/삭제 가능 -->
        {% if request.user.pk == portfolio_owner.pk %}
        <div class="portfolio_button">
            <a class="edit_btn" href="{% url 'portfolio:portfolio_update' portfolio.pk %}">게시물 수정</a>
            <a class="delete_btn" href="{% url 'portfolio:portfolio_delete' portfolio.pk %}">삭제</a>
        </div>
        {% endif %}
    </div>

    <!-- carousel, thumbnail image controls -->
    <div class="detail_right">
        <div class="img_container">

            <!--<img class="demo" src="{{portfolio.thumbnail.image.url}}" onclick="currentSlide(1)" alt="img">-->            
            {% for image in images %}
            {% if image %}
                <img class="demo" src="{{ image.image.url}}" onclick="currentSlide({{forloop.counter}}+1)" alt="img">
            {% endif %}
            {% endfor %}
        </div>
    </div>
</div>

    

    
</div>
{% endblock content %}

{% block script %}
<script type="text/javascript" src="{% static 'js/carousel.js' %}"></script>
<script type="text/javascript" src="{% static 'js/portfolio_like.js' %}"></script>
<script type="text/javascript" src="{% static 'js/portfolio_save.js' %}"></script>


{% endblock script %}